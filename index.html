<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÉ®‰∏ã„Éû„Éç„Ç∏„É°„É≥„Éà„Çµ„Éê„Ç§„Éê„É´</title>
    <!-- Tailwind CSS („Éá„Ç∂„Ç§„É≥Áî®) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM („Ç≤„Éº„É†„Ç®„É≥„Ç∏„É≥) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel („Ç≥„Éº„ÉâÂ§âÊèõÁî®) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº„ÅÆ„Ç´„Çπ„Çø„Éû„Ç§„Ç∫ */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <div id="root" class="w-full max-w-5xl h-[90vh]"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- „Ç¢„Ç§„Ç≥„É≥„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà (SVG) ---
        const IconBase = ({ children, color = "currentColor", size = 24, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>{children}</svg>
        );
        const Briefcase = (p) => <IconBase {...p}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></IconBase>;
        const MessageCircle = (p) => <IconBase {...p}><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></IconBase>;
        const Coffee = (p) => <IconBase {...p}><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></IconBase>;
        const History = (p) => <IconBase {...p}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/><path d="M12 7v5l4 2"/></IconBase>;
        const UserMinus = (p) => <IconBase {...p}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="22" x2="16" y1="11" y2="11"/></IconBase>;
        const Award = (p) => <IconBase {...p}><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/></IconBase>;
        const RefreshCw = (p) => <IconBase {...p}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></IconBase>;
        const TrendingUp = (p) => <IconBase {...p}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></IconBase>;
        const Zap = (p) => <IconBase {...p}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconBase>;

        // --- „Ç≤„Éº„É†ÂÆöÊï∞ & „Éá„Éº„Çø ---
        const MAX_WEEKS = 12;

        const MENTAL_STATES = [
            { id: 'conflict', label: 'ËëõËó§„ÉªÊäµÊäó', subLabel: '(ÊÄí„Çä„Å®ÂØæÁ´ã)', colorBg: '#FDE047', colorBorder: '#EAB308' },
            { id: 'resignation', label: 'Ë´¶„ÇÅ„ÉªÈÅ©Âøú', subLabel: '', colorBg: '#BBF7D0', colorBorder: '#86EFAC' },
            { id: 'quiet_quit', label: 'Èùô„Åã„Å™ÈÄÄËÅ∑', subLabel: '', colorBg: '#A5F3FC', colorBorder: '#67E8F9' },
            { id: 'apathy', label: 'ÁÑ°Èñ¢ÂøÉ', subLabel: '', colorBg: '#93C5FD', colorBorder: '#60A5FA' },
            { id: 'turnover', label: 'ÈÄÄËÅ∑„ÉªËª¢Âá∫', subLabel: '(Âç±Èô∫)', colorBg: '#C4B5FD', colorBorder: '#A78BFA' },
            { id: 'growth', label: 'ÂÖÖÂÆü„ÉªÊàêÈï∑', subLabel: '(ÁêÜÊÉ≥)', colorBg: '#DCA598', colorBorder: '#B97A6D' },
            { id: 'waver', label: 'Êè∫„Çâ„Åé„ÉªËø∑„ÅÑ', subLabel: '', colorBg: '#E7CBA9', colorBorder: '#D4A373' },
        ];

        // ÈÄ±„Åî„Å®„ÅÆÁí∞Â¢ÉÁä∂Ê≥ÅÔºà„Éï„É¨„Éº„Éê„Éº„ÉÜ„Ç≠„Çπ„ÉàÔºâ
        const WEEKLY_SITUATIONS = [
            { text: "Ê±∫ÁÆóÂâç„ÅÆÁπÅÂøôÊúü„Åß„ÄÅ„Ç™„Éï„Ç£„ÇπÂÖ®‰Ωì„Åå„Éî„É™„Éî„É™„Åó„Å¶„ÅÑ„Çã„ÄÇ", type: "busy" },
            { text: "Ê•≠ÁïåÊúÄÂ§ßÊâã„ÅÆ‰∏çÁ••‰∫ã„Åå„Éã„É•„Éº„Çπ„Å´„Å™„Çä„ÄÅÈ°ßÂÆ¢ÂØæÂøú„Å´ËøΩ„Çè„Çå„Å¶„ÅÑ„Çã„ÄÇ", type: "trouble" },
            { text: "ÈñëÊï£Êúü„Å´ÂÖ•„Çä„ÄÅÁ©è„ÇÑ„Åã„Å™Á©∫Ê∞ó„ÅåÊµÅ„Çå„Å¶„ÅÑ„Çã„ÄÇ", type: "calm" },
            { text: "Êñ∞ÂïÜÂìÅ„ÅåÂ§ß„Éí„ÉÉ„Éà„Åó„ÄÅÁ§æÂÜÖ„ÅØ„ÅäÁ•≠„ÇäÈ®í„Åé„Å†„ÄÇ", type: "good" },
            { text: "„Ç§„É≥„Éï„É´„Ç®„É≥„Ç∂„ÅåÊµÅË°å„Åó„Å¶„Åä„Çä„ÄÅÁ©∫Â∏≠„ÅåÁõÆÁ´ã„Å§„ÄÇ", type: "bad" },
            { text: "Â§ßÂûãÈÄ£‰ºë„ÇíÊéß„Åà„ÄÅ„Å©„Åì„ÅãÊµÆË∂≥Á´ã„Å£„ÅüÈõ∞Âõ≤Ê∞ó„Å†„ÄÇ", type: "calm" },
            { text: "Á´∂Âêà‰ªñÁ§æ„ÅåÊñ∞„Çµ„Éº„Éì„Çπ„ÇíÁô∫Ë°®„Åó„ÄÅÁ∑äÊÄ•‰ºöË≠∞„ÅåÁ∂ö„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ", type: "busy" },
            { text: "‰∏ªË¶ÅÂèñÂºïÂÖà„Å®„ÅÆÂ•ëÁ¥ÑÊõ¥Êñ∞„ÅåÁÑ°‰∫ã„Å´ÂÆå‰∫Ü„Åó„ÄÅÂÆâÂ†µÊÑü„ÅåÂ∫É„Åå„Å£„Å¶„ÅÑ„Çã„ÄÇ", type: "good" },
            { text: "„Ç∑„Çπ„ÉÜ„É†„ÅÆÂ§ßÂûã„Ç¢„ÉÉ„Éó„Éá„Éº„Éà‰ΩúÊ•≠„Åß„ÄÅ„Ç®„É≥„Ç∏„Éã„Ç¢‰ª•Â§ñ„ÇÇÂæÖÊ©ü„ÅåÁ∂ö„Åè„ÄÇ", type: "busy" },
            { text: "Êò•„ÅÆÈôΩÊ∞ó„Åß„ÄÅÁ™ì„ÅÆÂ§ñ„ÇíÁú∫„ÇÅ„ÇãÁ§æÂì°„ÅåÂ§ö„ÅÑ„ÄÇ", type: "calm" },
            { text: "„Ç≥„Çπ„ÉàÂâäÊ∏õ„ÅÆÈÄöÈÅî„Åå„ÅÇ„Çä„ÄÅÂÇôÂìÅ„ÅÆ‰ΩøÁî®„Å´„ÇÇÂà∂Èôê„Åå„Åã„Åã„Å£„Åü„ÄÇ", type: "bad" },
            { text: "„Éú„Éº„Éä„ÇπÊîØÁµ¶Êó•„ÅåËøë„Åè„ÄÅÁöÜ„ÅÆË°®ÊÉÖ„ÅåÊòé„Çã„ÅÑ„ÄÇ", type: "good" }
        ];

        const generateInitialStats = () => ({
            inst_fairness: Math.floor(30 + Math.random() * 40),
            inter_fairness: Math.floor(30 + Math.random() * 40),
            autonomy: Math.floor(30 + Math.random() * 40),
            competence: Math.floor(30 + Math.random() * 40),
            psych_load: Math.floor(20 + Math.random() * 30),
            phys_energy: Math.floor(60 + Math.random() * 40)
        });

        const ActionType = {
            WORK: 'work',
            COMMUNICATION: 'comm',
            REST: 'rest'
        };

        const pickMsg = (messages) => messages[Math.floor(Math.random() * messages.length)];

        // „Ç¢„ÇØ„Ç∑„Éß„É≥„É°„ÉÉ„Çª„Éº„Ç∏„Å´„ÄåÂú∞„ÅÆÊñá„Äç„ÇÑ„ÄåÁä∂Ê≥ÅÊèèÂÜô„Äç„ÇíËøΩÂä†
        const ACTIONS = [
            {
                id: 'praise',
                label: 'ÊàêÊûú„ÇíË§í„ÇÅ„Çã',
                type: ActionType.COMMUNICATION,
                desc: 'ÂÖ∑‰ΩìÁöÑ„Å™ÊàêÊûú„ÇíÊâøË™ç„Åô„Çã',
                effect: (stats) => ({
                    inst_fairness: +2, inter_fairness: +5, autonomy: 0, competence: +10, psych_load: -5, phys_energy: 0
                }),
                getMessages: (success) => success ? [
                    "„Äå„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ„Åù„Åì„ÄÅ„Åì„Å†„Çè„Å£„Åü„Çì„Åß„ÅôÔºÅ„ÄçÈÉ®‰∏ã„ÅØÂ¨â„Åó„Åù„ÅÜ„Å´È†≠„Çí„Åã„ÅÑ„Åü„ÄÇ",
                    "„ÄåÈÉ®Èï∑„Å´„Åù„ÅÜË®Ä„Å£„Å¶„ÇÇ„Çâ„Åà„Çã„Å®„ÄÅËá™‰ø°„Å´„Å™„Çä„Åæ„ÅôÔºÅ„ÄçÂ£∞Ëâ≤„ÅåÊòé„Çã„Åè„Å™„Å£„Åü„ÄÇ",
                    "„Äå„ÇÑ„Å£„ÅüÔºÅÊ¨°„ÅØ„ÇÇ„Å£„Å®„ÅÑ„ÅÑ„ÇÇ„ÅÆ‰Ωú„Çä„Åæ„Åô„Å≠ÔºÅ„Äç„É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥„ÅåÁõÆ„Å´Ë¶ã„Åà„Å¶‰∏ä„Åå„Å£„Åü„Çà„ÅÜ„Å†„ÄÇ",
                    "ÈÉ®‰∏ã„ÅÆË°®ÊÉÖ„Åå„Éë„ÉÉ„Å®ËèØ„ÇÑ„Åé„ÄÅ„Éá„Çπ„ÇØ„Å´Êàª„ÇãË∂≥Âèñ„Çä„ÇÇËªΩ„ÅÑ„ÄÇ",
                    "Âë®„Çä„ÅÆÁ§æÂì°„ÇÇÈ†∑„ÅÑ„Å¶„Åä„Çä„ÄÅ„ÉÅ„Éº„É†„ÅÆËâØ„ÅÑÈõ∞Âõ≤Ê∞ó‰Ωú„Çä„Å´Áπã„Åå„Å£„Åü„ÄÇ"
                ] : [
                    "„Äå„ÅÇ„ÄÅ„ÅØ„ÅÑ...„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄçÂèçÂøú„ÅØËñÑ„Åè„ÄÅ„Åô„Åê„Å´Ë¶ñÁ∑ö„ÇíÈÄ∏„Çâ„Åï„Çå„Åü„ÄÇ",
                    "„Äå„ÅØ„ÅÇ...Ôºà„ÇÇ„Å£„Å®Âà•„ÅÆ„Å®„Åì„Çç„ÇíË¶ã„Å¶„Åª„Åó„ÅÑ„Çì„Å†„Åë„Å©„Å™...Ôºâ„Äç‰∏çÊ∫Ä„Åí„Å™Á©∫Ê∞ó„ÅåÊºÇ„ÅÜ„ÄÇ",
                    "Ë§í„ÇÅ„Åü„ÇÇ„ÅÆ„ÅÆ„ÄÅÂøÉ„Å´Èüø„ÅÑ„Å¶„ÅÑ„Å™„ÅÑ„Çà„ÅÜ„Å†„ÄÇ„Çø„Ç§„Éü„É≥„Ç∞„ÅåÊÇ™„Åã„Å£„Åü„Åã..."
                ]
            },
            {
                id: 'scold',
                label: 'Âé≥„Åó„ÅèÊåáÂ∞é',
                type: ActionType.WORK,
                desc: 'ÊîπÂñÑÁÇπ„ÇíÊåáÊëò„Åó‰øÆÊ≠£„Åï„Åõ„Çã',
                effect: (stats) => {
                    const isTrusted = stats.inter_fairness > 60;
                    return {
                        inst_fairness: +2, inter_fairness: isTrusted ? 0 : -10, autonomy: -5, competence: isTrusted ? +5 : -10, psych_load: +15, phys_energy: -5
                    };
                },
                getMessages: (success) => success ? [
                    "„ÄåÁ¢∫„Åã„Å´„Åù„ÅÜ„Åß„Åô„Å≠...„ÄÇÊ¨°„Åã„Çâ„ÅØÁµ∂ÂØæ„Å´Ê∞ó„Çí„Å§„Åë„Åæ„ÅôÔºÅ„ÄçÁúüÂâ£„Å™ÁúºÂ∑Æ„Åó„Åß„É°„É¢„ÇíÂèñ„Å£„Å¶„ÅÑ„Çã„ÄÇ",
                    "„Äå„ÅîÊåáÊëò„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ„Åô„Åê„Å´‰øÆÊ≠£„Åó„Åæ„ÅôÔºÅ„Äç",
                    "„Äå„ÅÜ„Å£...Áóõ„ÅÑ„Å®„Åì„Çç„Çí...„ÄÇ„Åß„ÇÇ„ÄÅ„Åä„Å£„Åó„ÇÉ„ÇãÈÄö„Çä„Åß„Åô„ÄÇ„ÄçÊÇî„Åó„Åù„ÅÜ„Å†„Åå„ÄÅÁ¥çÂæó„ÅØ„Åó„Å¶„ÅÑ„Çã„Çà„ÅÜ„Å†„ÄÇ",
                    "„Éî„É™„ÉÉ„Å®„Åó„ÅüÁ∑äÂºµÊÑü„ÅåËµ∞„Å£„Åü„Åå„ÄÅÈÉ®‰∏ã„ÅØ„Åù„Çå„ÇíÊàêÈï∑„ÅÆÁ≥ß„Å®„Åó„Å¶Âèó„ÅëÊ≠¢„ÇÅ„Åü„Çà„ÅÜ„Å†„ÄÇ"
                ] : [
                    "„Äå„Åô„ÅÑ„Åæ„Åõ„Çì...Ôºà„Å™„Çì„ÅßËá™ÂàÜ„Å∞„Å£„Åã„Çä...Ôºâ„ÄçÈÉ®‰∏ã„ÅØÂîá„ÇíÂôõ„ÅøÁ∑†„ÇÅ„ÄÅ‰øØ„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ",
                    "„Äå...„ÅØ„ÅÑ„ÄÅ„Çè„Åã„Çä„Åæ„Åó„Åü„ÄÇ„ÄçÁ¥çÂæó„ÅÑ„Åã„Å™„ÅÑË°®ÊÉÖ„Åß„ÄÅÂ∞è„Åï„Å™„Åü„ÇÅÊÅØ„ÅåËÅû„Åì„Åà„Åü„ÄÇ",
                    "„ÄåÔºà„Åæ„ÅüÊÄí„Çâ„Çå„Åü...„ÇÇ„ÅÜÂ´å„Å†„Å™...Ôºâ„Äç„Ç™„Éï„Ç£„Çπ„ÅÆÁ©∫Ê∞ó„ÅåÈáç„Åè„Å™„Çä„ÄÅÂë®Âõ≤„ÇÇÊ∞ó„Åæ„Åö„Åù„ÅÜ„Å†„ÄÇ",
                    "ÊåáÂ∞é„ÅÆÂ£∞„Åå„Éï„É≠„Ç¢„Å´Èüø„Åç„ÄÅÈÉ®‰∏ã„ÅØÂßîÁ∏Æ„Åó„Å¶„Åó„Åæ„Å£„Åü„ÄÇ"
                ]
            },
            {
                id: 'delegate',
                label: '‰ªï‰∫ã„Çí‰ªª„Åõ„Çã',
                type: ActionType.WORK,
                desc: 'Ê®©ÈôêÂßîË≠≤„Åó„Å¶Ë¶ãÂÆà„Çã',
                effect: (stats) => ({
                    inst_fairness: 0, inter_fairness: +2, autonomy: +15, competence: +5, psych_load: +10, phys_energy: -10
                }),
                getMessages: (success) => [
                    "„Äå„Åì„Çå„ÄÅÂÉï„Åå„ÇÑ„Å£„Å¶„ÅÑ„ÅÑ„Çì„Åß„Åô„ÅãÔºü „ÇÑ„Çä„Åæ„ÅôÔºÅ„ÄçÁõÆ„ÇíËºù„Åã„Åõ„Å¶Ë≥áÊñô„ÇíÂèó„ÅëÂèñ„Å£„Åü„ÄÇ",
                    "„ÄåË≤¨‰ªªÈáçÂ§ß„Åß„Åô„Å≠...„Åß„ÇÇ„ÄÅ„ÉÅ„É£„É≥„Çπ„Å†„Å®ÊÄù„Å£„Å¶È†ëÂºµ„Çä„Åæ„ÅôÔºÅ„Äç",
                    "„Äå‰ªª„Åõ„Å¶„Åè„Å†„Åï„ÅÑÔºÅÊúüÂæÖ‰ª•‰∏ä„ÅÆÁµêÊûú„ÇíÂá∫„Åó„Å¶„Åø„Åõ„Åæ„Åô„Çà„ÄÇ„Äç",
                    "ÈÉ®‰∏ã„ÅØÂ∞ë„Åó‰∏çÂÆâ„Åù„ÅÜ„Å†„Åå„ÄÅ‰ªª„Åï„Çå„Åü„Åì„Å®„Å∏„ÅÆÊÑèÊ∞óËæº„Åø„ÇíÊÑü„Åò„Çã„ÄÇ",
                    "„Äå„Çè„Åã„Çä„Åæ„Åó„Åü„ÄçÁü≠„ÅÑËøî‰∫ã„Å†„Åå„ÄÅPC„Å´Âêë„Åã„ÅÜËÉå‰∏≠„Å´„ÅØÊ∞óÂêà„ÅåÂÖ•„Å£„Å¶„ÅÑ„Çã„ÄÇ"
                ]
            },
            {
                id: 'micro_manage',
                label: 'Á¥∞„Åã„ÅèÊåáÁ§∫Âá∫„Åó',
                type: ActionType.WORK,
                desc: 'ÈÄ≤Êçó„ÇíÁ¥∞ÈÉ®„Åæ„ÅßÁÆ°ÁêÜ„Åô„Çã',
                effect: (stats) => ({
                    inst_fairness: +5, inter_fairness: -2, autonomy: -15, competence: -5, psych_load: +5, phys_energy: -5
                }),
                getMessages: (success) => [
                    "„Äå„ÅÇ„ÄÅ„ÅØ„ÅÑ„ÄÇ„Åù„ÅÆÈÄö„Çä„Å´ÈÄ≤„ÇÅ„Åæ„Åô...„ÄçÈÉ®‰∏ã„ÅÆË°®ÊÉÖ„Åã„ÇâÁîüÊ∞ó„ÅåÊ∂à„Åà„Åü„ÄÇ",
                    "„ÄåÂ†±Âëä„Åß„Åô„Å≠„ÄÇ„Åà„Åà„Å®„ÄÅ‰ªä„ÅØ...„ÄçÁõ£Ë¶ñ„Åï„Çå„Å¶„ÅÑ„Çã„Å®ÊÑü„Åò„Å¶„ÅÑ„Çã„Çà„ÅÜ„Å†„ÄÇ",
                    "„ÄåÁ¥∞ÈÉ®„Åæ„ÅßÁ¢∫Ë™ç„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô...„ÄçÁöÆËÇâ„ÇÅ„ÅÑ„ÅüÈüø„Åç„ÅåÊ∑∑„Åò„Å£„Å¶„ÅÑ„Çã„ÄÇ",
                    "ÊâãÂèñ„ÇäË∂≥Âèñ„ÇäÊïô„Åà„Çã„Åì„Å®„Åß„Éü„Çπ„ÅØÈò≤„Åí„Åü„Åå„ÄÅÈÉ®‰∏ã„ÅØÁ™ÆÂ±à„Åù„ÅÜ„Å´ËÇ©„ÇíÂõû„Åó„Å¶„ÅÑ„Çã„ÄÇ",
                    "ÈÉ®‰∏ã„ÅØË®Ä„Çè„Çå„ÅüÈÄö„Çä„Å´Âãï„ÅÑ„Å¶„ÅÑ„Çã„Åå„ÄÅ„É≠„Éú„ÉÉ„Éà„ÅÆ„Çà„ÅÜ„Å™‰ΩúÊ•≠„Å∂„Çä„Å†„ÄÇ"
                ]
            },
            {
                id: 'listen',
                label: '1on1„ÅßÂÇæËÅ¥',
                type: ActionType.COMMUNICATION,
                desc: '‰∏çÊ∫Ä„ÇÑ„Ç≠„É£„É™„Ç¢„ÅÆÁõ∏Ë´á„Å´‰πó„Çã',
                effect: (stats) => ({
                    inst_fairness: +2, inter_fairness: +10, autonomy: +2, competence: +2, psych_load: -10, phys_energy: 0
                }),
                getMessages: (success) => [
                    "„ÄåÂÆü„ÅØÊúÄËøë„ÄÅÂ∞ë„ÅóÊÇ©„Çì„Åß„ÅÑ„Å¶...ËÅû„ÅÑ„Å¶„Åè„Çå„Åæ„Åô„ÅãÔºü„ÄçÈÉ®‰∏ã„ÅØÂ†∞„ÇíÂàá„Å£„Åü„Çà„ÅÜ„Å´Ë©±„ÅóÂßã„ÇÅ„Åü„ÄÇ",
                    "„ÄåÈÉ®Èï∑„Å®„Åì„ÅÜ„Åó„Å¶Ë©±„Åõ„Çã„Å®„ÄÅÈ†≠„ÅÆ‰∏≠„ÅåÊï¥ÁêÜ„Åß„Åç„Åæ„Åô„ÄÇ„Äç",
                    "„Äå„ÅÇ„Éº„ÄÅ„Çπ„ÉÉ„Ç≠„É™„Åó„Åæ„Åó„ÅüÔºÅ ËÅû„ÅÑ„Å¶„ÇÇ„Çâ„Åà„Å¶„Çà„Åã„Å£„Åü„Åß„Åô„ÄÇ„ÄçÁ¨ëÈ°î„ÅåÊàª„Å£„Åü„ÄÇ",
                    "‰ºöË≠∞ÂÆ§„Åß„Åò„Å£„Åè„Çä„Å®Ë©±„ÇíËÅû„ÅÑ„Åü„ÄÇÈÉ®‰∏ã„ÅÆÈ°îËâ≤„ÅåÂ∞ë„ÅóËâØ„Åè„Å™„Å£„ÅüÊ∞ó„Åå„Åô„Çã„ÄÇ",
                    "Ê•≠Âãô„ÅÆÊâã„ÇíÊ≠¢„ÇÅ„ÄÅÁúüÊëØ„Å´Âêë„ÅçÂêà„Å£„Åü„Åì„Å®„Åß„ÄÅ‰ø°È†ºÈñ¢‰øÇ„ÅåÊ∑±„Åæ„Å£„ÅüÊÑüË¶ö„Åå„ÅÇ„Çã„ÄÇ"
                ]
            },
            {
                id: 'explain_rule',
                label: 'Ë©ï‰æ°Âà∂Â∫¶„ÅÆË™¨Êòé',
                type: ActionType.COMMUNICATION,
                desc: 'Ë©ï‰æ°Âü∫Ê∫ñ„ÅÆÈÄèÊòéÊÄß„Çí‰ºù„Åà„Çã',
                effect: (stats) => ({
                    inst_fairness: +15, inter_fairness: +2, autonomy: 0, competence: 0, psych_load: 0, phys_energy: -2
                }),
                getMessages: (success) => [
                    "„Äå„Å™„Çã„Åª„Å©„ÄÅ„Åù„ÅÜ„ÅÑ„ÅÜÂü∫Ê∫ñ„Å†„Å£„Åü„Çì„Åß„Åô„Å≠„ÄÇ„ÇØ„É™„Ç¢„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ„Äç",
                    "„Äå‰Ωï„ÇíÁõÆÊåá„Åõ„Å∞„ÅÑ„ÅÑ„ÅãÂàÜ„Åã„Å£„Å¶„ÄÅ„É¢„É§„É¢„É§„ÅåÊô¥„Çå„Åæ„Åó„ÅüÔºÅ„ÄçË¶ñÁïå„ÅåÈñã„Åë„Åü„Çà„ÅÜ„Å†„ÄÇ",
                    "„ÄåÂÖ¨Âπ≥„Å´Ë¶ã„Å¶„Åè„Çå„Å¶„Çã„Å£„Å¶ÂàÜ„Åã„Å£„Å¶ÂÆâÂøÉ„Åó„Åæ„Åó„Åü„ÄÇ„Äç",
                    "„Éõ„ÉØ„Ç§„Éà„Éú„Éº„Éâ„Çí‰Ωø„Å£„Å¶Ë™¨Êòé„Åó„Åü„ÄÇÈÉ®‰∏ã„ÅØÁ¥çÂæó„Åó„Åü„Çà„ÅÜ„Å´‰ΩïÂ∫¶„ÇÇÈ†∑„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ",
                    "Ë©ï‰æ°„ÅÆÈÄèÊòéÊÄß„Çí‰ºù„Åà„Åü„Åì„Å®„Åß„ÄÅÁµÑÁπî„Å∏„ÅÆ‰∏ç‰ø°ÊÑü„ÅåÂíå„Çâ„ÅÑ„Å†„Çà„ÅÜ„Å†„ÄÇ"
                ]
            },
            {
                id: 'rest',
                label: '‰ºëÊÅØ„Çí‰øÉ„Åô',
                type: ActionType.REST,
                desc: 'Êó©Â∏∞„Çä„ÇíÊé®Â•®„Åô„Çã',
                effect: (stats) => ({
                    inst_fairness: 0, inter_fairness: +5, autonomy: 0, competence: 0, psych_load: -10, phys_energy: +15
                }),
                getMessages: (success) => [
                    "„Äå„Åà„ÄÅ„ÅÑ„ÅÑ„Çì„Åß„Åô„ÅãÔºü „Åò„ÇÉ„ÅÇ„ÄÅ„ÅäË®ÄËëâ„Å´Áîò„Åà„Å¶...„ÄçÈÉ®‰∏ã„ÅØ„Åù„Åù„Åè„Åï„Å®Â∏∞ÂÆÖ„ÅÆÊ∫ñÂÇô„ÇíÂßã„ÇÅ„Åü„ÄÇ",
                    "„ÄåÂä©„Åã„Çä„Åæ„Åô...ÊúÄËøë„Å°„Çá„Å£„Å®ÂØù‰∏çË∂≥Ê∞óÂë≥„Å†„Å£„Åü„ÅÆ„Åß„ÄÇ„ÄçÁõÆ„ÅÆ‰∏ã„ÅÆ„ÇØ„Éû„ÅåÂ∞ë„ÅóÊ∞ó„Å´„Å™„Çã„ÄÇ",
                    "„Äå„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ‰ªäÊó•„ÅØ„ÇÜ„Å£„Åè„ÇäÈ¢®ÂëÇ„Å´ÂÖ•„Å£„Å¶ÂØù„Åæ„ÅôÔºÅ„Äç",
                    "ÁÑ°ÁêÜ„Çí„Åï„Åõ„Åö„Å´Â∏∞„Åó„Åü„ÄÇ„Ç™„Éï„Ç£„Çπ„ÅÆÊòé„Åã„Çä„Åå‰∏Ä„Å§Ê∂à„Åà„ÄÅÈùôÂØÇ„ÅåÊàª„Çã„ÄÇ",
                    "„Äå„ÅäÂÖà„Å´Â§±Á§º„Åó„Åæ„ÅôÔºÅ„Äç‰πÖ„Åó„Å∂„Çä„Å´ÂÆöÊôÇ„ÅßÂ∏∞„ÇãÈÉ®‰∏ã„ÅÆËÉå‰∏≠„ÅØËªΩ„ÇÑ„Åã„Å†„ÄÇ"
                ]
            },
            {
                id: 'drink',
                label: 'È£≤„Åø„Éã„Ç±„Éº„Ç∑„Éß„É≥',
                type: ActionType.REST,
                desc: 'ËÖπ„ÇíÂâ≤„Å£„Å¶Ë©±„Åô',
                effect: (stats) => {
                    const success = Math.random() > 0.4;
                    return {
                        inst_fairness: 0, inter_fairness: success ? +10 : -5, autonomy: 0, competence: 0, psych_load: success ? -5 : +5, phys_energy: -10
                    };
                },
                getMessages: (success) => success ? [
                    "„Äå„ÅÑ„ÇÑ„Éº„ÄÅÈÉ®Èï∑„Åå„Åù„Çì„Å™ÈÅéÂéª„ÇíÊåÅ„Å£„Å¶„Åü„Å®„ÅØÔºÅÈù¢ÁôΩ„ÅÑ„Åß„ÅôÔºÅ„ÄçÈÖí„ÅÆÂ∏≠„Åß‰ºöË©±„ÅåÂºæ„Çì„Å†„ÄÇ",
                    "„Äå‰ªäÊó•Ë™ò„Å£„Å¶„ÇÇ„Çâ„Åà„Å¶ËâØ„Åã„Å£„Åü„Åß„Åô„ÄÇÊòéÊó•„Åã„Çâ„Åæ„ÅüÈ†ëÂºµ„Çä„Åæ„ÅôÔºÅ„Äç",
                    "„Äå„Å∂„Å£„Å°„ÇÉ„Åë„Åæ„Åô„Åë„Å©...ÈÉ®Èï∑„ÅÆ„Åì„Å®„ÄÅÊúÄÂàù„ÅØÊÄñ„Åã„Å£„Åü„Çì„Åß„Åô„ÇàÔºàÁ¨ëÔºâ„ÄçÊú¨Èü≥„Åå„Åì„Åº„Çå„Åü„ÄÇ",
                    "„Ç∞„É©„Çπ„ÇíÂÇæ„Åë„Å™„Åå„Çâ„ÄÅ‰ªï‰∫ã‰ª•Â§ñ„ÅÆË∂£Âë≥„ÅÆË©±„ÅßÁõõ„Çä‰∏ä„Åå„Å£„Åü„ÄÇ"
                ] : [
                    "„Äå„ÅÇ„ÄÅÊòéÊó•Êó©„ÅÑ„Çì„Åß„ÄÅ„Åù„Çç„Åù„Çç...„ÄçÈÉ®‰∏ã„ÅØÊôÇË®à„Çí„ÉÅ„É©„ÉÅ„É©Ë¶ã„Å¶„ÅÑ„Çã„ÄÇ",
                    "„Äå„ÅØ„ÅØ...„Åù„ÅÜ„Åß„Åô„Å≠...„ÄçÊÑõÊÉ≥Á¨ë„ÅÑ„ÇíÊµÆ„Åã„Åπ„Å¶„ÅÑ„Çã„Åå„ÄÅÁõÆ„ÅØÁ¨ë„Å£„Å¶„ÅÑ„Å™„ÅÑ„ÄÇ",
                    "„Äå„Åô„ÅÑ„Åæ„Åõ„Çì„ÄÅ„Å°„Çá„Å£„Å®ÈÖî„ÅÑ„ÅåÂõû„Å£„Å°„ÇÉ„Å£„Å¶...„ÄçÊ∞óÁñ≤„Çå„Åï„Åõ„Å¶„Åó„Åæ„Å£„Åü„Çà„ÅÜ„Å†„ÄÇ",
                    "Ê≤àÈªô„ÅåÁ∂ö„ÅèÊ∞ó„Åæ„Åö„ÅÑÊôÇÈñì„Å†„Å£„Åü„ÄÇÁÑ°ÁêÜ„Å´Ë™ò„ÅÜ„Åπ„Åç„Åß„ÅØ„Å™„Åã„Å£„Åü„Åã„ÇÇ„Åó„Çå„Å™„ÅÑ..."
                ]
            }
        ];

        const RANDOM_EVENTS = [
            { title: "‰∏çÈÄèÊòé„Å™‰∫∫‰∫ãÁï∞Âãï", desc: "„Äå„Å™„Çì„Åß„ÅÇ„ÅÆ‰∫∫„ÅåÊòáÈÄ≤„Åô„Çã„Çì„Åß„Åô„Åã...Ôºü„ÄçÈÉ®‰∏ã„Åå‰∏ç‰ø°ÊÑü„ÇíÊä±„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ", effect: { inst_fairness: -15, inter_fairness: 0, autonomy: 0, competence: 0, psych_load: +5, phys_energy: 0 } },
            { title: "„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂ§ßÊàêÂäü", desc: "„Äå„ÇÑ„Çä„Åæ„Åó„Åü„Å≠ÈÉ®Èï∑ÔºÅÁßÅ„Åü„Å°ÊúÄÈ´ò„Åò„ÇÉ„Å™„ÅÑ„Åß„Åô„ÅãÔºÅÔºü„Äç", effect: { inst_fairness: +5, inter_fairness: 0, autonomy: 0, competence: +15, psych_load: -5, phys_energy: -5 } },
            { title: "ÁπÅÂøôÊúüÁ™ÅÂÖ•", desc: "„ÄåÁµÇ„Çè„Çâ„Å™„ÅÑ...ÂÖ®ÁÑ∂‰ªï‰∫ã„ÅåÁµÇ„Çè„Çâ„Å™„ÅÑ„Åß„Åô„Çà...„Äç", effect: { inst_fairness: 0, inter_fairness: 0, autonomy: -5, competence: 0, psych_load: +10, phys_energy: -15 } },
            { title: "ÁêÜ‰∏çÂ∞Ω„Å™„ÇØ„É¨„Éº„É†", desc: "„ÄåÁßÅ„ÄÅ‰Ωï„ÇÇÊÇ™„Åè„Å™„ÅÑ„ÅÆ„Å´...„ÇÇ„ÅÜÁñ≤„Çå„Åæ„Åó„Åü...„Äç", effect: { inst_fairness: 0, inter_fairness: 0, autonomy: -5, competence: -5, psych_load: +15, phys_energy: -10 } },
            { title: "Êñ∞„Åó„ÅÑ„ÉÑ„Éº„É´„ÅÆÂ∞éÂÖ•", desc: "„Äå„Åì„ÇåÂáÑ„ÅÑÔºÅÈù¢ÂÄí„Å™‰ΩúÊ•≠„Åå‰∏ÄÁû¨„ÅßÁµÇ„Çè„Çä„Åæ„ÅôÔºÅ„Äç", effect: { inst_fairness: +5, inter_fairness: 0, autonomy: +5, competence: +5, psych_load: -5, phys_energy: +5 } }
        ];

        function SubordinateSurvival() {
            const [gameState, setGameState] = useState('start'); 
            const [week, setWeek] = useState(1);
            const [stats, setStats] = useState(generateInitialStats());
            const [parameterChanges, setParameterChanges] = useState({});
            const [lastMessage, setLastMessage] = useState("");
            const [eventMessage, setEventMessage] = useState(null);
            const [history, setHistory] = useState([]);
            const [currentActions, setCurrentActions] = useState([]);
            const [gameOverReason, setGameOverReason] = useState("");
            const [currentSituation, setCurrentSituation] = useState(WEEKLY_SITUATIONS[0]);
            const logsEndRef = useRef(null);

            useEffect(() => {
                logsEndRef.current?.scrollIntoView({ behavior: "smooth" });
            }, [history]);

            // ÈÄ±„ÅÆÁä∂Ê≥Å„Çí„É©„É≥„ÉÄ„É†Ë®≠ÂÆö
            const updateWeeklySituation = () => {
                const situation = WEEKLY_SITUATIONS[Math.floor(Math.random() * WEEKLY_SITUATIONS.length)];
                setCurrentSituation(situation);
                return situation;
            };

            // „Ç≤„Éº„É†ÈñãÂßã
            const startGame = () => {
                setStats(generateInitialStats()); 
                setParameterChanges({});
                setWeek(1);
                setGameState('playing');
                setLastMessage("„Äå‰ªäÊúü„ÇÇ„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÅÈÉ®Èï∑ÔºÅ„Äç");
                setEventMessage(null);
                setHistory([]);
                updateWeeklySituation();
                pickRandomActions();
            };

            // ÈÅ∏ÊäûËÇ¢„ÅÆ„É©„É≥„ÉÄ„É†ÊäΩÂá∫
            const pickRandomActions = () => {
                const shuffled = [...ACTIONS].sort(() => 0.5 - Math.random());
                setCurrentActions(shuffled.slice(0, 3));
            };

            // „Ç¢„ÇØ„Ç∑„Éß„É≥Âá¶ÁêÜ
            const handleAction = (action) => {
                const changes = action.effect(stats);
                let newStats = { ...stats };
                
                Object.keys(changes).forEach(key => {
                    newStats[key] += changes[key];
                });

                setParameterChanges(changes);

                let isSuccess = true;
                if (action.id === 'scold' && stats.inter_fairness <= 60) isSuccess = false;
                if (action.id === 'drink' && changes.inter_fairness < 0) isSuccess = false;
                if (action.id === 'praise' && stats.competence > 90) isSuccess = true;

                const possibleMessages = action.getMessages(isSuccess);
                const actionMsg = pickMsg(possibleMessages);
                
                setLastMessage(actionMsg);
                
                const newHistory = [...history, { week, type: 'action', text: `${action.label}: ${actionMsg}` }];

                // „É©„É≥„ÉÄ„É†„Ç§„Éô„É≥„Éà
                let evtMsg = null;
                if (Math.random() < 0.25 && week < MAX_WEEKS) {
                    const evt = RANDOM_EVENTS[Math.floor(Math.random() * RANDOM_EVENTS.length)];
                    Object.keys(evt.effect).forEach(key => {
                        newStats[key] += evt.effect[key];
                    });
                    evtMsg = evt;
                    newHistory.push({ week, type: 'event', text: `‚ö° ${evt.desc}` });
                }
                setEventMessage(evtMsg);
                setHistory(newHistory);

                // ÂÄ§„ÅÆÊ≠£Ë¶èÂåñ
                Object.keys(newStats).forEach(key => {
                    newStats[key] = Math.max(0, Math.min(100, newStats[key]));
                });

                setStats(newStats);
                checkGameState(newStats, week);
            };

            // „Ç≤„Éº„É†Áä∂ÊÖãÂà§ÂÆö
            const checkGameState = (currentStats, currentWeek) => {
                if (currentStats.psych_load >= 100) { finishGame('burnout'); return; }
                if (currentStats.phys_energy <= 0) { finishGame('exhaustion'); return; }
                if (currentStats.inst_fairness <= 0 || currentStats.inter_fairness <= 0) { finishGame('distrust'); return; }
                if (currentStats.competence <= 0) { finishGame('loss_confidence'); return; }

                if (currentWeek >= MAX_WEEKS) {
                    finishGame('victory');
                } else {
                    setWeek(prev => prev + 1);
                    updateWeeklySituation(); // ÈÄ±„ÅåÂ§â„Çè„Çã„Å®„Åç„Å´Áä∂Ê≥Å„ÇíÊõ¥Êñ∞
                    pickRandomActions();
                }
            };

            const finishGame = (reason) => {
                let reasonText = "";
                switch(reason) {
                    case 'burnout': reasonText = "„Äå„ÇÇ„ÅÜÁÑ°ÁêÜ„Åß„Åô...‰ºöÁ§æ„Å´Êù•„Çã„ÅÆ„ÅåÊÄñ„Åè„Å¶...„Äç‰ºëËÅ∑È°ò„ÅåÂá∫„Åï„Çå„Åæ„Åó„Åü„ÄÇÔºàÂéüÂõ†ÔºöÂøÉÁêÜÁöÑË≤†Ëç∑„ÅÆÈôêÁïåÔºâ"; break;
                    case 'exhaustion': reasonText = "Ê∑±Â§ú„ÄÅÈÉ®‰∏ã„Åå„Ç™„Éï„Ç£„Çπ„ÅßÂÄí„ÇåÊïëÊÄ•Êê¨ÈÄÅ„Åï„Çå„Åæ„Åó„Åü„ÄÇÔºàÂéüÂõ†ÔºöË∫´‰ΩìÁöÑ„Ç®„Éç„É´„ÇÆ„Éº„ÅÆÊûØÊ∏áÔºâ"; break;
                    case 'distrust': reasonText = "„Äå„Åì„ÅÆ‰ºöÁ§æ„ÅßÊ≠£ÂΩì„Å´Ë©ï‰æ°„Åï„Çå„ÇãÊú™Êù•„ÅåË¶ã„Åà„Åæ„Åõ„Çì„ÄÇ„ÄçÈÄÄËÅ∑Â±ä„ÅåÂá∫„Åï„Çå„Åæ„Åó„Åü„ÄÇÔºàÂéüÂõ†ÔºöÂÖ¨Âπ≥ÊÄß„ÅÆÊ¨†Â¶ÇÔºâ"; break;
                    case 'loss_confidence': reasonText = "„ÄåÂÉï„Å´„ÅØËç∑„ÅåÈáç„Åô„Åé„Åæ„Åó„Åü...„ÅîËø∑ÊÉë„Çí„Åä„Åã„Åë„Åó„Åæ„Åó„Åü„ÄÇ„ÄçÈÄÄËÅ∑Â±ä„ÅåÂá∫„Åï„Çå„Åæ„Åó„Åü„ÄÇÔºàÂéüÂõ†ÔºöÊúâÁî®ÊÑü„ÅÆÂñ™Â§±Ôºâ"; break;
                    default: reasonText = "ÈÉ®‰∏ã„ÅØÈÄÄËÅ∑„Åó„Åæ„Åó„Åü„ÄÇ";
                }
                setGameOverReason(reasonText);
                setGameState(reason === 'victory' ? 'victory' : 'gameover');
            };

            // --- Áä∂ÊÖãÂà§ÂÆö„É≠„Ç∏„ÉÉ„ÇØ ---
            const determineMentalStateId = (s) => {
                if (s.psych_load > 85 || s.phys_energy < 15 || s.inst_fairness < 15 || s.inter_fairness < 15) return 'turnover'; 
                if (s.inst_fairness < 40 && s.inter_fairness < 40 && s.phys_energy > 40) return 'conflict';
                if (s.autonomy < 40 && s.psych_load < 60) return 'resignation'; 
                if (s.competence < 40 && s.autonomy < 40) return 'quiet_quit'; 
                if (s.phys_energy < 40 && s.competence < 40) return 'apathy'; 
                if (s.autonomy > 60 && s.competence > 60 && s.phys_energy > 50 && s.inst_fairness > 50) return 'growth'; 
                return 'waver'; 
            };

            const currentMentalStateId = determineMentalStateId(stats);
            const currentStateIndex = MENTAL_STATES.findIndex(s => s.id === currentMentalStateId);
            const rotationAngle = -currentStateIndex * (360 / MENTAL_STATES.length); // ÂÜÜÂÖ®‰Ωì„ÇíÂõû„ÅôËßíÂ∫¶

            // --- UI„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà ---

            const ProgressBar = ({ label, value, change, color }) => (
                <div className="mb-2.5 w-full">
                    <div className="flex justify-between items-end text-xs text-white mb-0.5 px-0.5">
                        <span className="font-medium bg-slate-900/50 px-1 rounded">{label}</span>
                        <div className="flex gap-1 items-baseline">
                            {change !== 0 && change !== undefined && (
                                <span className={`text-[10px] ${change > 0 ? 'text-green-300' : 'text-red-300'}`}>
                                    {change > 0 ? '‚ñ≤' : '‚ñº'}{Math.abs(change)}
                                </span>
                            )}
                            <span className="font-mono font-bold text-sm">{value}</span>
                        </div>
                    </div>
                    <div className="w-full bg-slate-700/50 h-2.5 rounded-sm overflow-hidden backdrop-blur-sm border border-slate-600/50">
                        <div 
                            className="h-full transition-all duration-500 rounded-sm" 
                            style={{ width: `${value}%`, backgroundColor: color }}
                        />
                    </div>
                </div>
            );

            return (
                <div className="w-full max-w-5xl h-full md:h-auto bg-white rounded-xl shadow-2xl overflow-hidden border border-slate-200 flex flex-col">
                    
                    {/* Header */}
                    <div className="bg-slate-800 text-white p-4 flex justify-between items-center shrink-0">
                        <h1 className="font-bold text-lg flex items-center gap-2">
                            <Briefcase size={20} />
                            ÁµÑÁπîÂøÉÁêÜÂ≠¶„Çµ„Éê„Ç§„Éê„É´
                        </h1>
                        <div className="text-sm bg-slate-700 px-3 py-1 rounded-full font-mono">
                            Week {gameState === 'start' ? 1 : week} / {MAX_WEEKS}
                        </div>
                    </div>

                    {/* Start Screen */}
                    {gameState === 'start' && (
                        <div className="p-8 text-center flex-1 flex flex-col justify-center items-center">
                            <div className="mb-6 text-7xl">üè¢</div>
                            <h2 className="text-3xl font-bold mb-4">„Éû„Éç„Ç∏„É°„É≥„Éà„Éª„Çµ„Éê„Ç§„Éê„É´</h2>
                            <p className="text-gray-600 mb-8 leading-relaxed text-base max-w-lg">
                                „ÅÇ„Å™„Åü„ÅØ„Éû„Éç„Éº„Ç∏„É£„Éº„Å®„Åó„Å¶„ÄÅ<br/>
                                ÈÉ®‰∏ã„ÅÆ6„Å§„ÅÆÂøÉÁêÜ„Éë„É©„É°„Éº„Çø„ÇíÁÆ°ÁêÜ„Åó„Åæ„Åô„ÄÇ<br/><br/>
                                <strong>ÈÉ®‰∏ã„ÅÆÂøÉÁêÜ„ÅØÂ∏∏„Å´Â§âÂåñÔºàÂõûËª¢Ôºâ„Åó„Åæ„Åô„ÄÇ</strong><br/>
                                „ÄåÁèæÂú®„ÅÆÁä∂ÊÖã„Äç„ÅåÁúü‰∏äÔºà12ÊôÇÔºâ„Å´Êù•„Çã„Çà„ÅÜ„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ<br/>
                                Áä∂ÊÖã„ÇíË¶ãÊ•µ„ÇÅ„ÄÅ„ÄåÂÖÖÂÆü„ÉªÊàêÈï∑„Äç„Å∏Â∞é„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                            </p>
                            <button 
                                onClick={startGame}
                                className="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-lg text-lg transition-transform transform active:scale-95"
                            >
                                „Éû„Éç„Ç∏„É°„É≥„ÉàÈñãÂßãÔºàÂàùÊúü„Çπ„ÉÜ„Éº„Çø„ÇπÁîüÊàêÔºâ
                            </button>
                        </div>
                    )}

                    {/* Main Game Screen (Split Layout) */}
                    {gameState === 'playing' && (
                        <div className="flex flex-col md:flex-row h-full overflow-hidden">
                            
                            {/* Â∑¶„Ç´„É©„É†: „Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫„Ç®„É™„Ç¢ (ÂÜÜÁí∞) */}
                            <div className="flex-1 bg-slate-50/50 flex items-center justify-center p-6 relative overflow-hidden border-b md:border-b-0 md:border-r border-slate-200">
                                <div className="relative w-[400px] h-[400px] flex items-center justify-center">
                                    
                                    {/* ÂõûËª¢„Åô„Çã„Ç≥„É≥„ÉÜ„Éä */}
                                    <div 
                                        className="absolute w-full h-full flex items-center justify-center transition-transform duration-1000 ease-in-out"
                                        style={{ transform: `rotate(${rotationAngle}deg)` }}
                                    >
                                        {/* ËªåÈÅì„ÅÆÁÇπÁ∑öÂÜÜ */}
                                        <div className="absolute w-[340px] h-[340px] rounded-full border-2 border-dashed border-slate-300"></div>

                                        {/* Âë®Âõ≤„ÅÆ„Çπ„ÉÜ„Éº„Çø„ÇπÂÜÜ */}
                                        {MENTAL_STATES.map((state, index) => {
                                            const angle = index * (360 / MENTAL_STATES.length);
                                            const radius = 170; // ÂÜÜ„ÅÆÂçäÂæÑÊã°Â§ß
                                            const isActive = state.id === currentMentalStateId;

                                            return (
                                                <div
                                                    key={state.id}
                                                    className="absolute flex flex-col items-center justify-center text-center transition-all duration-500"
                                                    style={{
                                                        top: '50%',
                                                        left: '50%',
                                                        marginTop: '-3rem',
                                                        marginLeft: '-3rem',
                                                        transform: `rotate(${angle}deg) translate(0, -${radius}px) rotate(${-angle}deg) rotate(${-rotationAngle}deg)` 
                                                    }}
                                                >
                                                    <div 
                                                        className={`w-24 h-24 rounded-full flex flex-col items-center justify-center shadow-lg border-2 transition-all duration-500 ${isActive ? 'scale-110 ring-4 ring-offset-2 ring-yellow-200 font-bold z-10' : 'bg-white/90 border-slate-300 opacity-60'}`}
                                                        style={{ 
                                                            backgroundColor: isActive ? state.colorBg : undefined,
                                                            borderColor: isActive ? state.colorBorder : undefined
                                                        }}
                                                    >
                                                        <span className="text-sm text-slate-800 leading-tight px-2">{state.label}</span>
                                                        {state.subLabel && <span className="text-[10px] text-slate-500 mt-1">{state.subLabel}</span>}
                                                    </div>
                                                    {isActive && (
                                                        <div className="absolute -bottom-8 bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow animate-bounce whitespace-nowrap z-20 hidden md:block">
                                                            ÁèæÂú®: {state.label}
                                                        </div>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>

                                    {/* ‰∏≠Â§Æ„ÅÆÈªíÂÜÜÔºà„Éë„É©„É°„Éº„Çø„Ç≥„É≥„ÉÜ„Éä - ÂõûËª¢„Åó„Å™„ÅÑÔºâ */}
                                    <div className="absolute w-64 h-64 bg-slate-800 rounded-full flex flex-col justify-center px-8 shadow-2xl z-30 border-4 border-slate-600">
                                        <ProgressBar label="ÂÖ¨Âπ≥ÊÄß(Âà∂Â∫¶)" value={stats.inst_fairness} change={parameterChanges.inst_fairness} color="#60A5FA" />
                                        <ProgressBar label="ÂÖ¨Âπ≥ÊÄß(ÂØæ‰∫∫)" value={stats.inter_fairness} change={parameterChanges.inter_fairness} color="#818CF8" />
                                        <ProgressBar label="Ë£ÅÈáèÊÑü" value={stats.autonomy} change={parameterChanges.autonomy} color="#4ADE80" />
                                        <ProgressBar label="ÊúâÁî®ÊÑü" value={stats.competence} change={parameterChanges.competence} color="#2DD4BF" />
                                        <ProgressBar label="ÂøÉÁêÜÁöÑË≤†Ëç∑" value={stats.psych_load} change={parameterChanges.psych_load} color="#F472B6" />
                                        <ProgressBar label="Ë∫´‰Ωì„Ç®„Éä„Ç∏„Éº" value={stats.phys_energy} change={parameterChanges.phys_energy} color="#FB923C" />
                                    </div>

                                </div>
                            </div>

                            {/* Âè≥„Ç´„É©„É†: Êìç‰Ωú„Ç®„É™„Ç¢ */}
                            <div className="flex-1 flex flex-col min-w-0 bg-white z-20">
                                <div className="flex-1 overflow-y-auto p-6 flex flex-col justify-center">
                                    
                                    {/* ‰ªäÈÄ±„ÅÆÁä∂Ê≥Å„Éª„Éã„É•„Éº„ÇπË°®Á§∫ */}
                                    <div className="w-full mb-4">
                                        <div className="flex items-center gap-2 text-xs font-bold text-slate-400 mb-1 uppercase tracking-wider">
                                            <TrendingUp size={14} />
                                            ‰ªäÈÄ±„ÅÆËÅ∑Â†¥Áí∞Â¢É / Ê•≠Áïå„Éã„É•„Éº„Çπ
                                        </div>
                                        <div className={`p-3 rounded-lg border-l-4 text-sm font-medium ${
                                            currentSituation.type === 'busy' || currentSituation.type === 'trouble' || currentSituation.type === 'bad' 
                                            ? 'bg-red-50 border-red-400 text-red-800' 
                                            : currentSituation.type === 'good'
                                            ? 'bg-blue-50 border-blue-400 text-blue-800'
                                            : 'bg-gray-50 border-gray-400 text-gray-700'
                                        }`}>
                                            {currentSituation.text}
                                        </div>
                                    </div>

                                    {/* „É°„ÉÉ„Çª„Éº„Ç∏„Ç®„É™„Ç¢ */}
                                    <div className="w-full mb-6">
                                        <div className="bg-slate-100 px-6 py-4 rounded-xl text-base text-slate-700 w-full text-center border border-slate-200 min-h-[4rem] flex items-center justify-center shadow-inner italic relative">
                                            <span className="absolute top-2 left-2 text-3xl text-slate-200">"</span>
                                            {lastMessage}
                                            <span className="absolute bottom-2 right-2 text-3xl text-slate-200">"</span>
                                        </div>
                                        {eventMessage && (
                                            <div className="bg-yellow-50 px-4 py-3 mt-2 rounded-lg text-sm text-yellow-800 text-center border border-yellow-200 animate-pulse font-bold flex items-center justify-center gap-2">
                                                <Zap size={16} /> {eventMessage.title}: {eventMessage.desc}
                                            </div>
                                        )}
                                    </div>

                                    {/* „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ */}
                                    <div className="w-full space-y-3">
                                        <h3 className="text-sm font-bold text-gray-500 mb-2 flex items-center gap-2">
                                            <Briefcase size={16} />
                                            ‰ªäÈÄ±„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥Ôºà„É©„É≥„ÉÄ„É†ÈÅ∏Âá∫Ôºâ
                                        </h3>
                                        <div className="grid grid-cols-1 gap-3">
                                            {currentActions.map((action) => (
                                                <button
                                                    key={action.id}
                                                    onClick={() => handleAction(action)}
                                                    className="w-full text-left bg-white hover:bg-blue-50 border-2 border-slate-200 hover:border-blue-500 p-4 rounded-xl transition-all duration-200 group relative overflow-hidden shadow-sm active:scale-[0.99]"
                                                >
                                                    <div className="flex justify-between items-center relative z-10">
                                                        <div className="flex-1 min-w-0 pr-4">
                                                            <span className="font-bold text-slate-800 text-base block mb-1">{action.label}</span>
                                                            <span className="text-xs text-slate-500 block">{action.desc}</span>
                                                        </div>
                                                        <div className="bg-slate-50 text-slate-400 p-3 rounded-full group-hover:bg-blue-100 group-hover:text-blue-600 transition-colors shrink-0">
                                                            {action.type === ActionType.COMMUNICATION && <MessageCircle size={20} />}
                                                            {action.type === ActionType.WORK && <Briefcase size={20} />}
                                                            {action.type === ActionType.REST && <Coffee size={20} />}
                                                        </div>
                                                    </div>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                                
                                {/* Â±•Ê≠¥„É≠„Ç∞ (Âè≥‰∏ã) */}
                                <div className="bg-slate-50 border-t border-slate-200 p-3 h-40 shrink-0">
                                    <h4 className="text-xs font-bold text-gray-500 mb-2 flex items-center gap-1">
                                        <History size={12} />
                                        Ê¥ªÂãïÂ±•Ê≠¥
                                    </h4>
                                    <div className="h-full overflow-y-auto pb-6 text-xs space-y-2 pr-2 custom-scrollbar">
                                        {history.length === 0 ? (
                                            <p className="text-gray-400 italic text-center py-4">Â±•Ê≠¥„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                                        ) : (
                                            history.map((log, i) => (
                                                <div key={i} className={`p-2 rounded border ${log.type === 'event' ? 'bg-yellow-50 border-yellow-200 text-yellow-800' : 'bg-white border-slate-200 text-gray-700'}`}>
                                                    <span className="font-mono font-bold text-gray-400 mr-2 border-r border-gray-200 pr-2">W{log.week}</span>
                                                    {log.text}
                                                </div>
                                            ))
                                        )}
                                        <div ref={logsEndRef} />
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Game Over / Victory Screen */}
                    {(gameState === 'gameover' || gameState === 'victory') && (
                        <div className={`p-12 text-center flex-1 flex flex-col justify-center items-center ${gameState === 'victory' ? 'bg-blue-50' : 'bg-red-50'}`}>
                            {gameState === 'victory' ? (
                                <>
                                    <Award size={80} className="mx-auto text-yellow-500 mb-6" />
                                    <h2 className="text-3xl font-bold text-blue-900 mb-3">QUARTER COMPLETE!</h2>
                                    <p className="text-blue-700 mb-8 text-lg">„Éû„Éç„Ç∏„É°„É≥„ÉàÊàêÂäü„Åß„Åô„ÄÇÁ¥†Êô¥„Çâ„Åó„ÅÑ„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó„Åß„Åó„ÅüÔºÅ</p>
                                </>
                            ) : (
                                <>
                                    <UserMinus size={80} className="mx-auto text-red-500 mb-6" />
                                    <h2 className="text-3xl font-bold text-red-800 mb-3">GAME OVER</h2>
                                    <div className="bg-white p-6 rounded-xl shadow-md border border-red-100 mb-10 text-left relative mt-4 max-w-lg w-full">
                                        <div className="absolute -top-3 left-6 bg-red-100 text-red-800 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide">ÈÄÄËÅ∑/‰ºëËÅ∑Â±ä</div>
                                        <p className="text-gray-700 font-serif italic text-lg leading-relaxed mt-2">"{gameOverReason}"</p>
                                    </div>
                                </>
                            )}
                            
                            <button 
                                onClick={startGame}
                                className={`px-8 py-4 text-white font-bold rounded-lg shadow-lg text-lg transition flex items-center gap-2 ${gameState === 'victory' ? 'bg-blue-600 hover:bg-blue-700' : 'bg-slate-800 hover:bg-slate-900'}`}
                            >
                                <RefreshCw size={20} />
                                {gameState === 'victory' ? 'Ê¨°„ÅÆÊúü„Å∏' : 'ÂÜçÊåëÊà¶ÔºàÂàùÊúüÂÄ§„É©„É≥„ÉÄ„É†Ôºâ'}
                            </button>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SubordinateSurvival />);
    </script>
</body>
</html>
